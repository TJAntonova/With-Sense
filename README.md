# With-Sense

**Заказчик** -  фотохостинг для профессиональных фотографов «Со Смыслом» (“With Sense”). 

Пользователи размещают свои фотографии на хостинге и сопровождают их полным описанием: указывают место съёмок, модель камеры и т. д. Отличительная особенность сервиса — описание: его может предоставить не только тот, кто размещает фотографию, но и другие пользователи портала. 

Отдел занимается экспериментом по разработке поиска референсных фотографий для фотографов. Суть поиска заключается в следующем: пользователь сервиса вводит описание нужной сцены. Например, такое:
> A man is crossing a mountain pass on a metal bridge.

Сервис выводит несколько фотографий с такой же или похожей сценой.

**Цель проекта** - выбрать лучшую  модель, которая получит векторное представление изображения, векторное представление текста, а на выходе выдаст число от 0 до 1 — и покажет, насколько текст и картинка подходят друг другу. 

**Описание данных**

- В файле train_dataset.csv находится информация, необходимая для обучения: имя файла изображения, идентификатор описания и текст описания. Для одной картинки может быть доступно до 5 описаний. Идентификатор описания имеет формат <имя файла изображения>#<порядковый номер описания>.
- В папке train_images содержатся изображения для тренировки модели.
- В файле CrowdAnnotations.tsv  — данные по соответствию изображения и описания, полученные с помощью краудсорсинга. Номера колонок и соответствующий тип данных:
    - Имя файла изображения.
    - Идентификатор описания.
    - Доля людей, подтвердивших, что описание соответствует изображению.
    - Количество человек, подтвердивших, что описание соответствует изображению.
    - Количество человек, подтвердивших, что описание не соответствует изображению.
- В файле ExpertAnnotations.tsv  — данные по соответствию изображения и описания, полученные в результате опроса экспертов. Номера колонок и соответствующий тип данных:
    - Имя файла изображения.
    - Идентификатор описания.
    - 3, 4, 5 — оценки трёх экспертов (эксперты ставят оценки по шкале от 1 до 4, где 1 — изображение и запрос совершенно не соответствуют друг другу, 2 — запрос содержит элементы описания изображения, но в целом запрос тексту не соответствует, 3 — запрос и текст соответствуют с точностью до некоторых деталей, 4 — запрос и текст соответствуют полностью).      
- В файле test_queries.csv находится информация, необходимая для тестирования: идентификатор запроса, текст запроса и релевантное изображение. Для одной картинки может быть доступно до 5 описаний. Идентификатор описания имеет формат <имя файла изображения>#<порядковый номер описания>.
- В папке test_images содержатся изображения для тестирования модели.

**Задачи проекта**


1. Загрузить данные и провести исследовательский анализ данных.
2. Подготовить данные к обучению модели.
3. Обучить модель.
4. Протестировать модель и продемонстрировать ее работу.
5. Сделать общий вывод по работе.

В качестве моделей обязательно нужно рассмотреть:
1. Линейную регрессию;
2. Полносвязные нейронные сети.

При решении задачи необходимо использовать только один фреймворк  Pytorch или Keras.

*Юридические ограничения*

В некоторых странах, где работает компания With Sense, действуют ограничения по обработке изображений: поисковым сервисам и сервисам, предоставляющим возможность поиска, запрещено без разрешения родителей или законных представителей предоставлять любую информацию, в том числе, но не исключительно, текстов, изображений, видео и аудио, содержащие описание, изображение или запись голоса детей. Ребёнком считается любой человек, не достигший 16-ти лет. Во время тестирования модели при появлении в запросе “вредного” контента должен отображаться дисклеймер. 

**Выводы**
Оценки экспертов и краудсорсинга были аггрегированы и на их основе был сконструирован таргет - оценка схожести описания и изображения. Оценка лежит в диапазоне от нуля до единицы. Метрика качества - RMSE.

Была проверено качество работы линейной регрессии, которая показала не очень хороший результат.

Следующим шагом была проверена работа нейронной сети. Качество, которое она показала за 8 эпох обучения, показалось удовлетворительным - 0.25 rmse. Однако при проверке на тестовых данных модель показала среднее качество. Она выдавала изображения, на которых контекст схож с описанием, однако сходство лишь отдаленное. Только в одном из 8 случаев модель вывела нужную каринку. Один из способов, как можно было бы усовершенствовать модель - убедиться, что для каждого изображения (а также для каждого текстового описания) представлено одинаковое количество пар, отмеченных как "скорее совпадает" и "скорее не совпадает". Дисбаланс, при таком способе обучения, когда мы конкатенируем вектора, может спровоцировать тот факт, что модель начнет переобучаться под определенные изображения либо описания.
